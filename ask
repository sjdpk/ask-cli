#!/usr/bin/env python3
"""Ask CLI entry point script - Development and fallback version"""

import sys
from pathlib import Path

def main_wrapper():
    """Wrapper with comprehensive exception handling"""
    try:
        # Add src directory to Python path
        script_dir = Path(__file__).parent.resolve()
        src_dir = script_dir / "src"
        
        # Try local development version first
        if src_dir.exists():
            sys.path.insert(0, str(src_dir))
            try:
                from main import main
                main()
                return
            except ImportError:
                pass
        
        # Fallback for installed version via virtual environment
        venv_src_dir = Path.home() / ".ask-cli" / "src"
        if venv_src_dir.exists():
            sys.path.insert(0, str(venv_src_dir))
            try:
                from main import main
                main()
                return
            except ImportError:
                pass
        
        # Fallback for old user installation
        old_src_dir = Path.home() / ".local" / "bin" / "ask-src"
        if old_src_dir.exists():
            sys.path.insert(0, str(old_src_dir))
            try:
                from main import main
                main()
                return
            except ImportError:
                pass
        
        # No valid installation found
        print("âžœ Ask CLI installation not found.")
        print("   Please install using:")
        print("   curl -sSL https://raw.githubusercontent.com/sjdpk/ask-cli/main/install.sh | bash")
        print("")
        print("   Or for development, ensure you're in the project directory with 'src/' folder.")
        sys.exit(1)
        
    except KeyboardInterrupt:
        print("\n\nðŸ‘‹ Operation cancelled by user.")
        sys.exit(0)
    except SystemExit:
        # Allow normal sys.exit() calls to pass through
        raise
    except Exception as e:
        print(f"\nâžœ Unexpected error occurred: {str(e)}")
        print("   If this persists, please report this issue on GitHub:")
        print("   https://github.com/sjdpk/ask-cli/issues")
        sys.exit(1)

if __name__ == "__main__":
    main_wrapper()
